var w=mosaic.width=window.innerWidth,h=mosaic.height=window.innerHeight,sum=w+h,ctx=mosaic.getContext("2d"),opts={side:sideMosaic,picksParTick:shineMosaic,baseTime:base,addedTime:added,colors:[mosaic1+"alp)",mosaic2+"alp)",mosaic3+"alp)"],addedAlpha:20,strokeColor:stroke,hueSpeed:.2,repaintAlpha:1},difX=Math.sqrt(3)*opts.side/2,difY=3*opts.side/2,rad=Math.PI/6,cos=Math.cos(rad)*opts.side,sin=Math.sin(rad)*opts.side,hexs=[],tick=0;function loop(){window.requestAnimationFrame(loop),tick+=opts.hueSpeed,ctx.shadowBlur=0,ctx.fillStyle=backgroundColor+"alp)".replace("alp",opts.repaintAlpha),ctx.fillRect(0,0,w,h);for(var i=0;i<opts.picksParTick;++i)hexs[Math.random()*hexs.length|0].pick();hexs.map((function(i){i.step()}))}function Hex(i,t){this.x=i,this.y=t,this.sum=this.x+this.y,this.picked=!1,this.time=0,this.targetTime=0,this.xs=[this.x+cos,this.x,this.x-cos,this.x-cos,this.x,this.x+cos],this.ys=[this.y-sin,this.y-opts.side,this.y-sin,this.y+sin,this.y+opts.side,this.y+sin]}Hex.prototype.pick=function(){this.color=opts.colors[Math.random()*opts.colors.length|0],this.picked=!0,this.time=this.time||0,this.targetTime=this.targetTime||opts.baseTime+opts.addedTime*Math.random()|0},Hex.prototype.step=function(){var i=this.time/this.targetTime;ctx.beginPath(),ctx.moveTo(this.xs[0],this.ys[0]);for(var t=1;t<this.xs.length;++t)ctx.lineTo(this.xs[t],this.ys[t]);ctx.lineTo(this.xs[0],this.ys[0]),this.picked?(++this.time,this.time>=this.targetTime&&(this.time=0,this.targetTime=0,this.picked=!1),ctx.fillStyle=ctx.shadowColor=this.color.replace("alp",Math.sin(i*Math.PI)),ctx.fill()):(ctx.strokeStyle=ctx.shadowColor=opts.strokeColor,ctx.stroke())};for(var x=0;x<w;x+=2*difX)for(var i=0,y=0;y<h;y+=difY)++i,hexs.push(new Hex(x+difX*(i%2),y));loop(),window.addEventListener("resize",(function(){w=mosaic.width=window.innerWidth,h=mosaic.height=window.innerHeight,sum=w+h,hexs.length=0;for(var i=0;i<w;i+=2*difX)for(var t=0,s=0;s<h;s+=difY)++t,hexs.push(new Hex(i+difX*(t%2),s))}));