function createLandscape(e){var t,n,a,i,r=document.querySelector(".landscape"),o=window.innerWidth,s=window.innerHeight,l={x:0,y:0,xDamped:0,yDamped:0},u=void 0!==window.orientation;function m(){(m=new THREE.Sky).scale.setScalar(45e4),m.material.uniforms.turbidity.value=13,m.material.uniforms.rayleigh.value=1.2,m.material.uniforms.luminance.value=1,m.material.uniforms.mieCoefficient.value=.1,m.material.uniforms.mieDirectionalG.value=.58,t.add(m),sunSphere=new THREE.Mesh(new THREE.SphereBufferGeometry(2e4,16,8),new THREE.MeshBasicMaterial({color:16777215})),sunSphere.visible=!1,t.add(sunSphere);var e=-.002*Math.PI,n=2*Math.PI*-.25;sunSphere.position.x=4e5*Math.cos(n),sunSphere.position.y=4e5*Math.sin(n)*Math.sin(e),sunSphere.position.z=4e5*Math.sin(n)*Math.cos(e),m.material.uniforms.sunPosition.value.copy(sunSphere.position)}function d(){o=window.innerWidth,s=window.innerHeight,a.aspect=o/s,a.updateProjectionMatrix(),n.setSize(o,s)}function c(e){var t,n;e.preventDefault(),"mousemove"==e.type?(t=e.clientX,n=e.clientY):(t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY),l.x=t,l.y=n}function p(){requestAnimationFrame(p),l.xDamped=v(l.xDamped,l.x,.1),l.yDamped=v(l.yDamped,l.y,.1);var e=.001*performance.now();i.material.uniforms.time.value=e,i.material.uniforms.scroll.value=e+f(l.yDamped,0,s,0,4),i.material.uniforms.distortCenter.value=.1*Math.sin(e),i.material.uniforms.roadWidth.value=f(l.xDamped,0,o,1,4.5),a.position.y=f(l.yDamped,0,s,4,11),n.render(t,a)}function f(e,t,n,a,i){return a+(e-t)/(n-t)*(i-a)}function v(e,t,n){return(1-n)*e+n*t}!function(){(function(){t=new THREE.Scene;var e=new THREE.Color(3355443);t.background=e,t.fog=new THREE.Fog(e,0,400),m(),(a=new THREE.PerspectiveCamera(60,o/s,.1,1e4)).position.y=8,a.position.z=4,ambientLight=new THREE.AmbientLight(16777215,1),t.add(ambientLight),(n=new THREE.WebGLRenderer({canvas:r,antialias:!0})).setPixelRatio=devicePixelRatio,n.setSize(o,s)})(),l=new THREE.PlaneBufferGeometry(100,400,400,400),f={time:{type:"f",value:0},scroll:{type:"f",value:0},distortCenter:{type:"f",value:.1},roadWidth:{type:"f",value:.5},pallete:{type:"t",value:null},speed:{type:"f",value:3},maxHeight:{type:"f",value:10},color:new THREE.Color(1,1,1)},v=new THREE.ShaderMaterial({uniforms:THREE.UniformsUtils.merge([THREE.ShaderLib.basic.uniforms,f]),vertexShader:document.getElementById("custom-vertex").textContent,fragmentShader:document.getElementById("custom-fragment").textContent,wireframe:!1,fog:!0}),(i=new THREE.Mesh(l,v)).position.z=-180,i.rotation.x=-Math.PI/2,void t.add(i),void(new THREE.TextureLoader).load(e.palleteImage,(function(e){i.material.uniforms.pallete.value=e,i.material.needsUpdate=!0})),p(),u?window.addEventListener("touchmove",c,{passive:!1}):window.addEventListener("mousemove",c);var l,f,v;window.addEventListener("resize",d),d()}()}createLandscape({palleteImage:pallete});